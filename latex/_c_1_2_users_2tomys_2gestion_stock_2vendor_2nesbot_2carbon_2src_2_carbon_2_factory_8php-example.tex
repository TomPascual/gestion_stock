\doxysection{C\+:/\+Users/tomys/gestion\+\_\+stock/vendor/nesbot/carbon/src/\+Carbon/\+Factory.\+php}
\hypertarget{_c_1_2_users_2tomys_2gestion_stock_2vendor_2nesbot_2carbon_2src_2_carbon_2_factory_8php-example}{}\label{_c_1_2_users_2tomys_2gestion_stock_2vendor_2nesbot_2carbon_2src_2_carbon_2_factory_8php-example}Register a custom macro.

Pass null macro to remove it.


\begin{DoxyCode}{0}
\DoxyCodeLine{\$userSettings\ =\ [}
\DoxyCodeLine{\ \ \textcolor{stringliteral}{'locale'}\ =>\ \textcolor{stringliteral}{'pt'},}
\DoxyCodeLine{\ \ \textcolor{stringliteral}{'timezone'}\ =>\ \textcolor{stringliteral}{'America/Sao\_Paulo'},}
\DoxyCodeLine{];}
\DoxyCodeLine{\$factory-\/>macro(\textcolor{stringliteral}{'userFormat'},\ \textcolor{keyword}{function}\ ()\ use\ (\$userSettings)\ \{}
\DoxyCodeLine{\ \ \textcolor{keywordflow}{return}\ \$this-\/>copy()-\/>locale(\$userSettings[\textcolor{stringliteral}{'locale'}])-\/>tz(\$userSettings[\textcolor{stringliteral}{'timezone'}])-\/>calendar();}
\DoxyCodeLine{\});}
\DoxyCodeLine{echo\ \$factory-\/>yesterday()-\/>hours(11)-\/>userFormat();}

\end{DoxyCode}



\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{<?php}
\DoxyCodeLine{}
\DoxyCodeLine{declare(strict\_types=1);}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_carbon}{Carbon}};}
\DoxyCodeLine{}
\DoxyCodeLine{use\ Closure;}
\DoxyCodeLine{use\ DateTimeImmutable;}
\DoxyCodeLine{use\ DateTimeInterface;}
\DoxyCodeLine{use\ DateTimeZone;}
\DoxyCodeLine{use\ InvalidArgumentException;}
\DoxyCodeLine{use\ ReflectionMethod;}
\DoxyCodeLine{use\ RuntimeException;}
\DoxyCodeLine{use\ \mbox{\hyperlink{interface_symfony_1_1_contracts_1_1_translation_1_1_translator_interface}{Symfony\(\backslash\)Contracts\(\backslash\)Translation\(\backslash\)TranslatorInterface}};}
\DoxyCodeLine{use\ Throwable;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{class\ }Factory}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keywordtype}{string}\ \$className\ =\ Carbon::class;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ array\ \$settings\ =\ [];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ Closure|CarbonInterface|\textcolor{keyword}{null}\ \$testNow\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ ?\textcolor{keywordtype}{string}\ \$testDefaultTimezone\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keywordtype}{bool}\ \$useTimezoneFromTestNow\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ TranslatorInterface\ \$translator;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ array\ \$weekendDays\ =\ [}
\DoxyCodeLine{\ \ \ \ \ \ \ \ CarbonInterface::SATURDAY,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ CarbonInterface::SUNDAY,}
\DoxyCodeLine{\ \ \ \ ];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ array\ \$regexFormats\ =\ [}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'d'}\ =>\ \textcolor{stringliteral}{'(3[01]|[12][0-\/9]|0[1-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'D'}\ =>\ \textcolor{stringliteral}{'(Sun|Mon|Tue|Wed|Thu|Fri|Sat)'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'j'}\ =>\ \textcolor{stringliteral}{'([123][0-\/9]|[1-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'l'}\ =>\ \textcolor{stringliteral}{'([a-\/zA-\/Z]\{2,\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'N'}\ =>\ \textcolor{stringliteral}{'([1-\/7])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'S'}\ =>\ \textcolor{stringliteral}{'(st|nd|rd|th)'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'w'}\ =>\ \textcolor{stringliteral}{'([0-\/6])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'z'}\ =>\ \textcolor{stringliteral}{'(36[0-\/5]|3[0-\/5][0-\/9]|[12][0-\/9]\{2\}|[1-\/9]?[0-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'W'}\ =>\ \textcolor{stringliteral}{'(5[012]|[1-\/4][0-\/9]|0?[1-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'F'}\ =>\ \textcolor{stringliteral}{'([a-\/zA-\/Z]\{2,\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'m'}\ =>\ \textcolor{stringliteral}{'(1[012]|0[1-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'M'}\ =>\ \textcolor{stringliteral}{'([a-\/zA-\/Z]\{3\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'n'}\ =>\ \textcolor{stringliteral}{'(1[012]|[1-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'t'}\ =>\ \textcolor{stringliteral}{'(2[89]|3[01])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'L'}\ =>\ \textcolor{stringliteral}{'(0|1)'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'o'}\ =>\ \textcolor{stringliteral}{'([1-\/9][0-\/9]\{0,4\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'Y'}\ =>\ \textcolor{stringliteral}{'([1-\/9]?[0-\/9]\{4\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'y'}\ =>\ \textcolor{stringliteral}{'([0-\/9]\{2\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'a'}\ =>\ \textcolor{stringliteral}{'(am|pm)'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'A'}\ =>\ \textcolor{stringliteral}{'(AM|PM)'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'B'}\ =>\ \textcolor{stringliteral}{'([0-\/9]\{3\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'g'}\ =>\ \textcolor{stringliteral}{'(1[012]|[1-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'G'}\ =>\ \textcolor{stringliteral}{'(2[0-\/3]|1?[0-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'h'}\ =>\ \textcolor{stringliteral}{'(1[012]|0[1-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'H'}\ =>\ \textcolor{stringliteral}{'(2[0-\/3]|[01][0-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'i'}\ =>\ \textcolor{stringliteral}{'([0-\/5][0-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'s'}\ =>\ \textcolor{stringliteral}{'([0-\/5][0-\/9])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'u'}\ =>\ \textcolor{stringliteral}{'([0-\/9]\{1,6\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'v'}\ =>\ \textcolor{stringliteral}{'([0-\/9]\{1,3\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'e'}\ =>\ \textcolor{stringliteral}{'([a-\/zA-\/Z]\{1,5\})|([a-\/zA-\/Z]*\(\backslash\)\(\backslash\)/[a-\/zA-\/Z]*)'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'I'}\ =>\ \textcolor{stringliteral}{'(0|1)'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'O'}\ =>\ \textcolor{stringliteral}{'([+-\/](1[0123]|0[0-\/9])[0134][05])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'P'}\ =>\ \textcolor{stringliteral}{'([+-\/](1[0123]|0[0-\/9]):[0134][05])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'p'}\ =>\ \textcolor{stringliteral}{'(Z|[+-\/](1[0123]|0[0-\/9]):[0134][05])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'T'}\ =>\ \textcolor{stringliteral}{'([a-\/zA-\/Z]\{1,5\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'Z'}\ =>\ \textcolor{stringliteral}{'(-\/?[1-\/5]?[0-\/9]\{1,4\})'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'U'}\ =>\ \textcolor{stringliteral}{'([0-\/9]*)'},}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ formats\ below\ are\ combinations\ of\ the\ above\ formats.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'c'}\ =>\ \textcolor{stringliteral}{'(([1-\/9]?[0-\/9]\{4\})-\/(1[012]|0[1-\/9])-\/(3[01]|[12][0-\/9]|0[1-\/9])T(2[0-\/3]|[01][0-\/9]):([0-\/5][0-\/9]):([0-\/5][0-\/9])[+-\/](1[012]|0[0-\/9]):([0134][05]))'},\ \textcolor{comment}{//\ Y-\/m-\/dTH:i:sP}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'r'}\ =>\ \textcolor{stringliteral}{'(([a-\/zA-\/Z]\{3\}),\ ([123][0-\/9]|0[1-\/9])\ ([a-\/zA-\/Z]\{3\})\ ([1-\/9]?[0-\/9]\{4\})\ (2[0-\/3]|[01][0-\/9]):([0-\/5][0-\/9]):([0-\/5][0-\/9])\ [+-\/](1[012]|0[0-\/9])([0134][05]))'},\ \textcolor{comment}{//\ D,\ d\ M\ Y\ H:i:s\ O}}
\DoxyCodeLine{\ \ \ \ ];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ array\ \$regexFormatModifiers\ =\ [}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'*'}\ =>\ \textcolor{stringliteral}{'.+'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'\ '}\ =>\ \textcolor{stringliteral}{'[\ \ \ ]'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'\#'}\ =>\ \textcolor{stringliteral}{'[;:\(\backslash\)\(\backslash\)/.,()-\/]'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'?'}\ =>\ \textcolor{stringliteral}{'([\string^a]|[a])'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'!'}\ =>\ \textcolor{stringliteral}{''},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'|'}\ =>\ \textcolor{stringliteral}{''},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{charliteral}{'+'}\ =>\ \textcolor{stringliteral}{''},}
\DoxyCodeLine{\ \ \ \ ];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \_\_construct(array\ \$settings\ =\ [],\ ?\textcolor{keywordtype}{string}\ \$className\ =\ \textcolor{keyword}{null})}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$className)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>className\ =\ \$className;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_a7ab4265d7259dfda3ff6a8fd388776b2}{settings}}\ =\ \$settings;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getClassName():\ string}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>className;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setClassName(\textcolor{keywordtype}{string}\ \$className):\ self}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>className\ =\ \$className;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ className(?\textcolor{keywordtype}{string}\ \$className\ =\ \textcolor{keyword}{null}):\ self|string}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$className\ ===\ \textcolor{keyword}{null}\ ?\ \$this-\/>getClassName()\ :\ \$this-\/>setClassName(\$className);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}():\ array}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>settings;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setSettings(array\ \$settings):\ self}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_a7ab4265d7259dfda3ff6a8fd388776b2}{settings}}\ =\ \$settings;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{namespace_carbon_1_1_traits_a7ab4265d7259dfda3ff6a8fd388776b2}{settings}}(?array\ \$settings\ =\ \textcolor{keyword}{null}):\ self|array}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$settings\ ===\ \textcolor{keyword}{null}\ ?\ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()\ :\ \$this-\/>setSettings(\$settings);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ mergeSettings(array\ \$settings):\ self}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_a7ab4265d7259dfda3ff6a8fd388776b2}{settings}}\ =\ array\_merge(\$this-\/>settings,\ \$settings);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setHumanDiffOptions(\textcolor{keywordtype}{int}\ \$humanDiffOptions):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'humanDiffOptions'}\ =>\ \$humanDiffOptions,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ enableHumanDiffOption(\$humanDiffOption):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>setHumanDiffOptions(\$this-\/>getHumanDiffOptions()\ |\ \$humanDiffOption);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ disableHumanDiffOption(\textcolor{keywordtype}{int}\ \$humanDiffOption):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>setHumanDiffOptions(\$this-\/>getHumanDiffOptions()\ \&\ \string~\$humanDiffOption);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getHumanDiffOptions():\ int}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})\ (\$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'humanDiffOptions'}]\ ??\ 0);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ macro(\textcolor{keywordtype}{string}\ \$name,\ ?callable\ \$macro):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$macros\ =\ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'macros'}]\ ??\ [];}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$macros[\$name]\ =\ \$macro;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'macros'}\ =>\ \$macros,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ resetMacros():\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'macros'}\ =>\ \textcolor{keyword}{null},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'genericMacros'}\ =>\ \textcolor{keyword}{null},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ genericMacro(callable\ \$macro,\ \textcolor{keywordtype}{int}\ \$priority\ =\ 0):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$genericMacros\ =\ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'genericMacros'}]\ ??\ [];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isset(\$genericMacros[\$priority]))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$genericMacros[\$priority]\ =\ [];}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ krsort(\$genericMacros,\ SORT\_NUMERIC);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$genericMacros[\$priority][]\ =\ \$macro;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'genericMacros'}\ =>\ \$genericMacros,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ hasMacro(\textcolor{keywordtype}{string}\ \$name):\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ isset(\$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'macros'}][\$name]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getMacro(\textcolor{keywordtype}{string}\ \$name):\ ?callable}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'macros'}][\$name]\ ??\ \textcolor{keyword}{null};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setTranslator(TranslatorInterface\ \$translator):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>translator\ =\ \$translator;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getTranslator():\ TranslatorInterface}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>translator\ ??=\ Translator::get();}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ resetToStringFormat():\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>setToStringFormat(\textcolor{keyword}{null});}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setToStringFormat(\textcolor{keywordtype}{string}|Closure|\textcolor{keyword}{null}\ \$format):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'toStringFormat'}\ =>\ \$format,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ serializeUsing(\textcolor{keywordtype}{string}|callable|\textcolor{keyword}{null}\ \$format):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'toJsonFormat'}\ =>\ \$format,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ useStrictMode(\textcolor{keywordtype}{bool}\ \$strictModeEnabled\ =\ \textcolor{keyword}{true}):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'strictMode'}\ =>\ \$strictModeEnabled,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ isStrictModeEnabled():\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'strictMode'}]\ ??\ \textcolor{keyword}{true};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ useMonthsOverflow(\textcolor{keywordtype}{bool}\ \$monthsOverflow\ =\ \textcolor{keyword}{true}):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'monthOverflow'}\ =>\ \$monthsOverflow,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ resetMonthsOverflow():\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>useMonthsOverflow();}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ shouldOverflowMonths():\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'monthOverflow'}]\ ??\ \textcolor{keyword}{true};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ useYearsOverflow(\textcolor{keywordtype}{bool}\ \$yearsOverflow\ =\ \textcolor{keyword}{true}):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>mergeSettings([}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'yearOverflow'}\ =>\ \$yearsOverflow,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ]);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ resetYearsOverflow():\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>useYearsOverflow();}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ shouldOverflowYears():\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>\mbox{\hyperlink{namespace_carbon_1_1_traits_ad732b45f6730ffd2bff7b8af19086306}{getSettings}}()[\textcolor{stringliteral}{'yearOverflow'}]\ ??\ \textcolor{keyword}{true};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getWeekendDays():\ array}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>weekendDays;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setWeekendDays(array\ \$days):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>weekendDays\ =\ \$days;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ hasFormat(\textcolor{keywordtype}{string}\ \$date,\ \textcolor{keywordtype}{string}\ \$format):\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ createFromFormat()\ is\ known\ to\ handle\ edge\ cases\ silently.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ E.g.\ "{}1975-\/5-\/1"{}\ (Y-\/n-\/j)\ will\ still\ be\ parsed\ correctly\ when\ "{}Y-\/m-\/d"{}\ is\ supplied\ as\ the\ format.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ To\ ensure\ we're\ really\ testing\ against\ our\ desired\ format,\ perform\ an\ additional\ regex\ validation.}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>matchFormatPattern(\$date,\ preg\_quote(\$format,\ \textcolor{charliteral}{'/'}),\ \$this-\/>regexFormats);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ hasFormatWithModifiers(\textcolor{keywordtype}{string}\ \$date,\ \textcolor{keywordtype}{string}\ \$format):\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>matchFormatPattern(\$date,\ \$format,\ array\_merge(\$this-\/>regexFormats,\ \$this-\/>regexFormatModifiers));}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setTestNow(mixed\ \$testNow\ =\ \textcolor{keyword}{null}):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>useTimezoneFromTestNow\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>testNow\ =\ \$testNow\ instanceof\ \textcolor{keyword}{self}\ ||\ \$testNow\ instanceof\ Closure}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ?\ \$testNow}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ :\ \$this-\/>make(\$testNow);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ setTestNowAndTimezone(mixed\ \$testNow\ =\ \textcolor{keyword}{null},\ \$timezone\ =\ \textcolor{keyword}{null}):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$testNow)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>testDefaultTimezone\ ??=\ date\_default\_timezone\_get();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$useDateInstanceTimezone\ =\ \$testNow\ instanceof\ DateTimeInterface;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$useDateInstanceTimezone)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>setDefaultTimezone(\$testNow-\/>getTimezone()-\/>getName(),\ \$testNow);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>setTestNow(\$testNow);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>useTimezoneFromTestNow\ =\ (\$timezone\ ===\ \textcolor{keyword}{null}\ \&\&\ \$testNow\ instanceof\ Closure);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$useDateInstanceTimezone)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$now\ =\ \$this-\/>getMockedTestNow(\(\backslash\)func\_num\_args()\ ===\ 1\ ?\ \textcolor{keyword}{null}\ :\ \$timezone);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>setDefaultTimezone(\$now?-\/>tzName\ ??\ \$this-\/>testDefaultTimezone\ ??\ \textcolor{stringliteral}{'UTC'},\ \$now);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$testNow)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>testDefaultTimezone\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ withTestNow(mixed\ \$testNow,\ callable\ \$callback):\ mixed}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$this-\/>setTestNow(\$testNow);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$callback();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{finally}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>setTestNow();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$result;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ getTestNow():\ Closure|CarbonInterface|null}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$this-\/>testNow\ ===\ \textcolor{keyword}{null})\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$factory\ =\ FactoryImmutable::getDefaultInstance();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$factory\ !==\ \$this)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$factory-\/>getTestNow();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>testNow;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ handleTestNowClosure(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ Closure|CarbonInterface|\textcolor{keyword}{null}\ \$testNow,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ DateTimeZone|\textcolor{keywordtype}{string}|\textcolor{keywordtype}{int}|\textcolor{keyword}{null}\ \$timezone\ =\ \textcolor{keyword}{null},}
\DoxyCodeLine{\ \ \ \ ):\ ?CarbonInterface\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ if\ (\$testNow\ instanceof\ Closure)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$callback\ =\ Callback::fromClosure(\$testNow);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$realNow\ =\ \textcolor{keyword}{new}\ DateTimeImmutable(\textcolor{stringliteral}{'now'});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$testNow\ =\ \$testNow(\$callback-\/>prepareParameter(\$this-\/>parse(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$realNow-\/>format(\textcolor{stringliteral}{'Y-\/m-\/d\ H:i:s.u'}),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$timezone\ ??\ \$realNow-\/>getTimezone(),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ )));}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$testNow\ !==\ \textcolor{keyword}{null}\ \&\&\ !(\$testNow\ instanceof\ DateTimeInterface))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$function\ =\ \$callback-\/>getReflectionFunction();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$type\ =\ \(\backslash\)is\_object(\$testNow)\ ?\ \$testNow::class\ :\ \(\backslash\)gettype(\$testNow);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ RuntimeException(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'The\ test\ closure\ defined\ in\ '}.\$function-\/>getFileName().}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'\ at\ line\ '}.\$function-\/>getStartLine().\textcolor{stringliteral}{'\ returned\ '}.\$type.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{';\ expected\ '}.CarbonInterface::class.\textcolor{stringliteral}{'|null'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\$testNow\ instanceof\ CarbonInterface))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$timezone\ ??=\ \$this-\/>useTimezoneFromTestNow\ ?\ \$testNow-\/>getTimezone()\ :\ \textcolor{keyword}{null};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$testNow\ =\ \$this-\/>\_\_call(\textcolor{stringliteral}{'instance'},\ [\$testNow,\ \$timezone]);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$testNow;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ hasTestNow():\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>getTestNow()\ !==\ \textcolor{keyword}{null};}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ withTimeZone(DateTimeZone|\textcolor{keywordtype}{string}|\textcolor{keywordtype}{int}|\textcolor{keyword}{null}\ \$timezone):\ static}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$factory\ =\ \mbox{\hyperlink{namespace_carbon_1_1_traits_ab9cb43f7b45f227d2426299bac08b6ef}{clone}}\ \$this;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$factory-\/>settings[\textcolor{stringliteral}{'timezone'}]\ =\ \$timezone;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$factory;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \_\_call(\textcolor{keywordtype}{string}\ \$name,\ array\ \$arguments):\ mixed}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$method\ =\ \textcolor{keyword}{new}\ ReflectionMethod(\$this-\/>className,\ \$name);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$settings\ =\ \$this-\/>settings;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$settings\ \&\&\ isset(\$settings[\textcolor{stringliteral}{'timezone'}]))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$timezoneParameters\ =\ array\_filter(\$method-\/>getParameters(),\ function\ (\$parameter)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ \(\backslash\)in\_array(\$parameter-\/>getName(),\ [\textcolor{stringliteral}{'tz'},\ \textcolor{stringliteral}{'timezone'}],\ \textcolor{keyword}{true});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$timezoneSetting\ =\ \$settings[\textcolor{stringliteral}{'timezone'}];}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$arguments[0])\ \&\&\ \(\backslash\)in\_array(\$name,\ [\textcolor{stringliteral}{'instance'},\ \textcolor{stringliteral}{'make'},\ \textcolor{stringliteral}{'create'},\ \textcolor{stringliteral}{'parse'}],\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$arguments[0]\ instanceof\ DateTimeInterface)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$settings[\textcolor{stringliteral}{'innerTimezone'}]\ =\ \$settings[\textcolor{stringliteral}{'timezone'}];}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ elseif\ (\(\backslash\)is\_string(\$arguments[0])\ \&\&\ date\_parse(\$arguments[0])[\textcolor{stringliteral}{'is\_localtime'}])\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unset(\$settings[\textcolor{stringliteral}{'timezone'}],\ \$settings[\textcolor{stringliteral}{'innerTimezone'}]);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)count(\$timezoneParameters))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$index\ =\ key(\$timezoneParameters);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isset(\$arguments[\$index]))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ array\_splice(\$arguments,\ key(\$timezoneParameters),\ 0,\ [\$timezoneSetting]);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unset(\$settings[\textcolor{stringliteral}{'timezone'}]);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$clock\ =\ FactoryImmutable::getCurrentClock();}
\DoxyCodeLine{\ \ \ \ \ \ \ \ FactoryImmutable::setCurrentClock(\$this);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>className::\$name(...\$arguments);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{finally}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ FactoryImmutable::setCurrentClock(\$clock);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$this-\/>translator))\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$settings[\textcolor{stringliteral}{'translator'}]\ =\ \$this-\/>translator;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$result\ instanceof\ CarbonInterface\ \&\&\ !empty(\$settings)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ?\ \$result-\/>settings(\$settings)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ :\ \$result;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{function}\ getMockedTestNow(DateTimeZone|\textcolor{keywordtype}{string}|\textcolor{keywordtype}{int}|\textcolor{keyword}{null}\ \$timezone):\ ?CarbonInterface}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$testNow\ =\ \$this-\/>handleTestNowClosure(\$this-\/>getTestNow());}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$testNow\ instanceof\ CarbonInterface)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$testNow\ =\ \$testNow-\/>avoidMutation();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$timezone\ !==\ \textcolor{keyword}{null})\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$testNow-\/>setTimezone(\$timezone);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$testNow;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ matchFormatPattern(\textcolor{keywordtype}{string}\ \$date,\ \textcolor{keywordtype}{string}\ \$format,\ array\ \$replacements):\ bool}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Preg\ quote,\ but\ remove\ escaped\ backslashes\ since\ we'll\ deal\ with\ escaped\ characters\ in\ the\ format\ string.}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$regex\ =\ str\_replace(\textcolor{stringliteral}{'\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)'},\ \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'},\ \$format);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Replace\ not-\/escaped\ letters}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$regex\ =\ preg\_replace\_callback(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'/(?<!\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\))((?:\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)\{2\})*)(['}.implode(\textcolor{stringliteral}{''},\ array\_keys(\$replacements)).\textcolor{stringliteral}{'])/'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ fn\ (\$match)\ =>\ \$match[1].strtr(\$match[2],\ \$replacements),}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$regex,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Replace\ escaped\ letters\ by\ the\ letter\ itself}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$regex\ =\ preg\_replace(\textcolor{stringliteral}{'/(?<!\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\))((?:\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)\{2\})*)\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)(\(\backslash\)w)/'},\ \textcolor{stringliteral}{'\$1\$2'},\ \$regex);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Escape\ not\ escaped\ slashes}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$regex\ =\ preg\_replace(\textcolor{stringliteral}{'\#(?<!\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\))((?:\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)\{2\})*)/\#'},\ \textcolor{stringliteral}{'\$1\(\backslash\)\(\backslash\)/'},\ \$regex);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{bool})\ @preg\_match(\textcolor{stringliteral}{'/\string^'}.\$regex.\textcolor{stringliteral}{'\$/'},\ \$date);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ setDefaultTimezone(\textcolor{keywordtype}{string}\ \$timezone,\ ?DateTimeInterface\ \$date\ =\ \textcolor{keyword}{null}):\ void}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$previous\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \$success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$success\ =\ date\_default\_timezone\_set(\$timezone);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (Throwable\ \$exception)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$previous\ =\ \$exception;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$success)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \$suggestion\ =\ @CarbonTimeZone::create(\$timezone)-\/>toRegionName(\$date);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidArgumentException(}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Timezone\ ID\ '\$timezone'\ is\ invalid"{}}.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\$suggestion\ \&\&\ \$suggestion\ !==\ \$timezone\ ?\ \textcolor{stringliteral}{"{},\ did\ you\ mean\ '\$suggestion'?"{}}\ :\ \textcolor{charliteral}{'.'}).\textcolor{stringliteral}{"{}\(\backslash\)n"{}}.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}It\ must\ be\ one\ of\ the\ IDs\ from\ DateTimeZone::listIdentifiers(),\(\backslash\)n"{}}.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'For\ the\ record,\ hours/minutes\ offset\ are\ relevant\ only\ for\ a\ particular\ moment,\ '}.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'but\ not\ as\ a\ default\ timezone.'},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$previous}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCodeInclude}
 