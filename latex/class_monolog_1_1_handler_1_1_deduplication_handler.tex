\doxysection{Monolog\textbackslash{}Handler\textbackslash{}Deduplication\+Handler Class Reference}
\hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler}{}\label{class_monolog_1_1_handler_1_1_deduplication_handler}\index{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}}
Inheritance diagram for Monolog\textbackslash{}Handler\textbackslash{}Deduplication\+Handler\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.439024cm]{class_monolog_1_1_handler_1_1_deduplication_handler}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_deduplication_handler_ada0a364178bb10c462e1229423c182f9}{\+\_\+\+\_\+construct}} (\mbox{\hyperlink{interface_monolog_1_1_handler_1_1_handler_interface}{Handler\+Interface}} \$handler, ?string \$deduplication\+Store=null, int\texorpdfstring{$\vert$}{|}string\texorpdfstring{$\vert$}{|}Level \$deduplication\+Level=Level\+::\+Error, int \$time=60, bool \$bubble=true)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_deduplication_handler_ae9f1e6c6a67dbff91aa6c796d3ab813e}{flush}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler}{Monolog\textbackslash{}\+Handler\textbackslash{}\+Buffer\+Handler}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler_af8b9a25f7d9da25e33b677c9c151c959}{\+\_\+\+\_\+construct}} (\mbox{\hyperlink{interface_monolog_1_1_handler_1_1_handler_interface}{Handler\+Interface}} \$handler, int \$buffer\+Limit=0, int\texorpdfstring{$\vert$}{|}string\texorpdfstring{$\vert$}{|}Level \$level=Level\+::\+Debug, bool \$bubble=true, bool \$flush\+On\+Overflow=false)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler_abbc8f5f2c8d57db838a3ac11c0e3d03a}{handle}} (\mbox{\hyperlink{class_monolog_1_1_log_record}{Log\+Record}} \$record)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler_a9219d1b616a77464bda3ee4ed81b2e22}{close}} ()
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler_a1a23e1392fdf649131fde71f5525d78f}{clear}} ()
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler_a504468165f0da1a2a17f7e4f81c41f6c}{reset}} ()
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler_a68468bc5e990e0f5f6172cb690c9091b}{set\+Formatter}} (\mbox{\hyperlink{interface_monolog_1_1_formatter_1_1_formatter_interface}{Formatter\+Interface}} \$formatter)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler_a11c9e98686c8da75f79ca3c33a519686}{get\+Formatter}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler}{Monolog\textbackslash{}\+Handler\textbackslash{}\+Abstract\+Handler}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler_ac7aa3733ecb055b715b3bf32f2a705c2}{\+\_\+\+\_\+construct}} (int\texorpdfstring{$\vert$}{|}string\texorpdfstring{$\vert$}{|}Level \$level=Level\+::\+Debug, bool \$bubble=true)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler_a4db293ae756304f9eebac94394655322}{is\+Handling}} (\mbox{\hyperlink{class_monolog_1_1_log_record}{Log\+Record}} \$record)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler_a1b2969dede93d4bc0e1510a931f8ff88}{set\+Level}} (int\texorpdfstring{$\vert$}{|}string\texorpdfstring{$\vert$}{|}Level \$level)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler_add1449d0c17746feec37c794a18e3a9f}{get\+Level}} ()
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler_a4befb1a01b856f3b8ea10194f88f6e88}{set\+Bubble}} (bool \$bubble)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler_a11da3967fa955d92c915a1d53d73ac72}{get\+Bubble}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_monolog_1_1_handler_1_1_handler}{Monolog\textbackslash{}\+Handler\textbackslash{}\+Handler}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_handler_afc043f871cc3b239c06844659c57b1f3}{handle\+Batch}} (array \$records)
\item 
{\bfseries \+\_\+\+\_\+sleep} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{interface_monolog_1_1_handler_1_1_processable_handler_interface}{Monolog\textbackslash{}\+Handler\textbackslash{}\+Processable\+Handler\+Interface}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{interface_monolog_1_1_handler_1_1_processable_handler_interface_a53a4d8869fec50c20d98ffc48b3c7965}{push\+Processor}} (callable \$callback)
\item 
\mbox{\hyperlink{interface_monolog_1_1_handler_1_1_processable_handler_interface_a42e02d07c11a9a32101e1c626e48b80b}{pop\+Processor}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_deduplication_handler_a366c9b2d97ca4725b4a5bd610c1cbcee}{is\+Duplicate}} (array \$store, \mbox{\hyperlink{class_monolog_1_1_log_record}{Log\+Record}} \$record)
\item 
\mbox{\hyperlink{class_monolog_1_1_handler_1_1_deduplication_handler_a2c1f93e1f53ca3365a1353c22ce94a6e}{build\+Deduplication\+Store\+Entry}} (\mbox{\hyperlink{class_monolog_1_1_log_record}{Log\+Record}} \$record)
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_a5361ea3989f73990e6f65cf95dd2574a}\label{class_monolog_1_1_handler_1_1_deduplication_handler_a5361ea3989f73990e6f65cf95dd2574a} 
string {\bfseries \$deduplication\+Store}
\item 
\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_a9547b6437c3c57f87f8b5bbc2e7e91ad}\label{class_monolog_1_1_handler_1_1_deduplication_handler_a9547b6437c3c57f87f8b5bbc2e7e91ad} 
Level {\bfseries \$deduplication\+Level}
\item 
\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_a3949959e239648ebde73cb07df551d76}\label{class_monolog_1_1_handler_1_1_deduplication_handler_a3949959e239648ebde73cb07df551d76} 
int {\bfseries \$time}
\item 
\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_a27b2949a0e74079b558cba0ef5e7f8d4}\label{class_monolog_1_1_handler_1_1_deduplication_handler_a27b2949a0e74079b558cba0ef5e7f8d4} 
bool {\bfseries \$gc} = false
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler}{Monolog\textbackslash{}\+Handler\textbackslash{}\+Buffer\+Handler}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{interface_monolog_1_1_handler_1_1_handler_interface}{Handler\+Interface}} {\bfseries \$handler}
\item 
int {\bfseries \$buffer\+Size} = 0
\item 
int {\bfseries \$buffer\+Limit}
\item 
bool {\bfseries \$flush\+On\+Overflow}
\item 
array {\bfseries \$buffer} = \mbox{[}$\,$\mbox{]}
\item 
bool {\bfseries \$initialized} = false
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{class_monolog_1_1_handler_1_1_abstract_handler}{Monolog\textbackslash{}\+Handler\textbackslash{}\+Abstract\+Handler}}}
\begin{DoxyCompactItemize}
\item 
Level {\bfseries \$level} = Level\+::\+Debug
\item 
bool {\bfseries \$bubble} = true
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Simple handler wrapper that deduplicates log records across multiple requests

It also includes the Buffer\+Handler functionality and will buffer all messages until the end of the request or flush() is called.

This works by storing all log records\textquotesingle{} messages above \$deduplication\+Level to the file specified by \$deduplication\+Store. When further logs come in at the end of the request (or when flush() is called), all those above \$deduplication\+Level are checked against the existing stored logs. If they match and the timestamps in the stored log is not older than \$time seconds, the new log record is discarded. If no log record is new, the whole data set is discarded.

This is mainly useful in combination with Mail handlers or things like Slack or Hip\+Chat handlers that send messages to people, to avoid spamming with the same message over and over in case of a major component failure like a database server being down which makes all requests fail in the same way.

\begin{DoxyAuthor}{Author}
Jordi Boggiano \href{mailto:j.boggiano@seld.be}{\texttt{ j.\+boggiano@seld.\+be}} 
\end{DoxyAuthor}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_ada0a364178bb10c462e1229423c182f9}\index{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}!\_\_construct@{\_\_construct}}
\index{\_\_construct@{\_\_construct}!Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}}
\doxysubsubsection{\texorpdfstring{\_\_construct()}{\_\_construct()}}
{\footnotesize\ttfamily \label{class_monolog_1_1_handler_1_1_deduplication_handler_ada0a364178bb10c462e1229423c182f9} 
Monolog\textbackslash{}\+Handler\textbackslash{}\+Deduplication\+Handler\+::\+\_\+\+\_\+construct (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{interface_monolog_1_1_handler_1_1_handler_interface}{Handler\+Interface}}}]{\$handler}{, }\item[{?string}]{\$deduplication\+Store}{ = {\ttfamily null}, }\item[{int\texorpdfstring{$\vert$}{|}string\texorpdfstring{$\vert$}{|}Level}]{\$deduplication\+Level}{ = {\ttfamily Level\+:\+:Error}, }\item[{int}]{\$time}{ = {\ttfamily 60}, }\item[{bool}]{\$bubble}{ = {\ttfamily true}}\end{DoxyParamCaption})}


\begin{DoxyParams}[1]{Parameters}
Handler\+Interface & {\em \$handler} & Handler. \\
\hline
string | null & {\em \$deduplication\+Store} & The file/path where the deduplication log should be kept \\
\hline
 & {\em int\texorpdfstring{$\vert$}{|}string\texorpdfstring{$\vert$}{|}\+Level\texorpdfstring{$\vert$}{|}\+Log\+Level\+::\texorpdfstring{$\ast$}{*}} & \$deduplication\+Level The minimum logging level for log records to be looked at for deduplication purposes \\
\hline
int & {\em \$time} & The period (in seconds) during which duplicate entries should be suppressed after a given log is sent through \\
\hline
bool & {\em \$bubble} & Whether the messages that are handled can bubble up the stack or not\\
\hline
\end{DoxyParams}
@phpstan-\/param value-\/of\texorpdfstring{$<$}{<}Level\+::\+VALUES\texorpdfstring{$>$}{>}\texorpdfstring{$\vert$}{|}value-\/of\texorpdfstring{$<$}{<}Level\+::\+NAMES\texorpdfstring{$>$}{>}\texorpdfstring{$\vert$}{|}\+Level\texorpdfstring{$\vert$}{|}\+Log\+Level\+::\texorpdfstring{$\ast$}{*} \$deduplication\+Level 

\doxysubsection{Member Function Documentation}
\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_a2c1f93e1f53ca3365a1353c22ce94a6e}\index{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}!buildDeduplicationStoreEntry@{buildDeduplicationStoreEntry}}
\index{buildDeduplicationStoreEntry@{buildDeduplicationStoreEntry}!Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}}
\doxysubsubsection{\texorpdfstring{buildDeduplicationStoreEntry()}{buildDeduplicationStoreEntry()}}
{\footnotesize\ttfamily \label{class_monolog_1_1_handler_1_1_deduplication_handler_a2c1f93e1f53ca3365a1353c22ce94a6e} 
Monolog\textbackslash{}\+Handler\textbackslash{}\+Deduplication\+Handler\+::build\+Deduplication\+Store\+Entry (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_monolog_1_1_log_record}{Log\+Record}}}]{\$record}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyReturn}{Returns}
string The given record serialized as a single line of text 
\end{DoxyReturn}
\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_ae9f1e6c6a67dbff91aa6c796d3ab813e}\index{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}!flush@{flush}}
\index{flush@{flush}!Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}}
\doxysubsubsection{\texorpdfstring{flush()}{flush()}}
{\footnotesize\ttfamily \label{class_monolog_1_1_handler_1_1_deduplication_handler_ae9f1e6c6a67dbff91aa6c796d3ab813e} 
Monolog\textbackslash{}\+Handler\textbackslash{}\+Deduplication\+Handler\+::flush (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Reimplemented from \mbox{\hyperlink{class_monolog_1_1_handler_1_1_buffer_handler}{Monolog\textbackslash{}\+Handler\textbackslash{}\+Buffer\+Handler}}.

\Hypertarget{class_monolog_1_1_handler_1_1_deduplication_handler_a366c9b2d97ca4725b4a5bd610c1cbcee}\index{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}!isDuplicate@{isDuplicate}}
\index{isDuplicate@{isDuplicate}!Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler@{Monolog\textbackslash{}Handler\textbackslash{}DeduplicationHandler}}
\doxysubsubsection{\texorpdfstring{isDuplicate()}{isDuplicate()}}
{\footnotesize\ttfamily \label{class_monolog_1_1_handler_1_1_deduplication_handler_a366c9b2d97ca4725b4a5bd610c1cbcee} 
Monolog\textbackslash{}\+Handler\textbackslash{}\+Deduplication\+Handler\+::is\+Duplicate (\begin{DoxyParamCaption}\item[{array}]{\$store}{, }\item[{\mbox{\hyperlink{class_monolog_1_1_log_record}{Log\+Record}}}]{\$record}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

If there is a store entry older than e.\+g. a day, this method should set {\ttfamily \$this-\/\texorpdfstring{$>$}{>}gc} to {\ttfamily true} to trigger garbage collection. 
\begin{DoxyParams}[1]{Parameters}
string\mbox{[}$\,$\mbox{]} & {\em \$store} & The deduplication store \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
vendor/monolog/monolog/src/\+Monolog/\+Handler/Deduplication\+Handler.\+php\end{DoxyCompactItemize}
